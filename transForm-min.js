/*!
 * jQuery TransForm plugin v0.9
 * 2014-07-27
 *
 * Copyright (c) 2010-2014 Pavel Tzonkov <sunhater@sunhater.com>
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b){var a;b.fn.transForm=function(p){if(!a){var d=b("<div></div>").css({display:"block",visibility:"visible",position:"absolute",overflow:"auto",width:100,height:100,top:-1000,left:-1000}).prependTo("body").append("<div></div>").find("div").css({display:"block",visibility:"visible",width:"100%",height:200});a=100-d.width();d.parent().remove()}var q="|form|fieldset|input|select|textarea|button|label|",i="|text|password|color|datetime|datetime-local|email|month|number|range|search|tel|time|url|week|",e={cssPrefix:"tf-",file:{noFile:"No file chosen",browse:"Browse",count:"{count} files"},textarea:{autoExpand:false,maxLength:0}},n=function(s,t,v){var u=0,o;if(!v){v="mbp"}if(/m/i.test(v)){o=parseInt(b(s).css("margin-"+t));if(o){u+=o}}if(/b/i.test(v)){o=parseInt(b(s).css("border-"+t+"-width"));if(o){u+=o}}if(/p/i.test(v)){o=parseInt(b(s).css("padding-"+t));if(o){u+=o}}return u},h=function(o,r){return n(o,"left",r)},j=function(o,r){return n(o,"top",r)},g=function(o,r){return n(o,"right",r)},m=function(o,r){return n(o,"bottom",r)},l=function(o,r){return(h(o,r)+g(o,r))},f=function(o,r){return(j(o,r)+m(o,r))},c=function(o){var r="mousewheel.tf DOMMouseScroll.tf";b(o).unbind(r).bind(r,function(s){var u=s.originalEvent,t=u.wheelDelta||-u.detail;this.scrollTop+=((t<0)?1:-1)*30;s.preventDefault()})},k=function(o){b(o).each(function(){var r="selectstart.tf";b(this).css("MozUserSelect","none");b(this).unbind(r).bind(r,function(){return false})})};b.extend(true,e,p);b(this).each(function(){var H=this,s=b(H).prop("tagName").toLowerCase();if(q.indexOf("|"+s+"|")==-1){return}var C=(p===false),z=b(H).data("transForm"),F=(!C&&!z),u=(C&&z),y=z?z.prefix:e.cssPrefix,A=b(H).attr("type"),A=A?A:"text",r,B={},E=function(I,t){if(F){b(I).addClass(t)}else{if(u){b(I).removeClass(t)}}},G=function(t){return y+t},o=function(t){return"."+G(t)},w={set:function(t,I){if(typeof I=="undefined"){I=H}var J=b(I).data("transForm");if(!J){J={}}b.extend(true,J,t);b(I).data("transForm",J)},get:function(t,I){if(typeof I=="undefined"){I=H}var J=b(I).data("transForm");if(typeof t=="undefined"){return J}if(!J){J={}}return J[t]},remove:function(t,I){if(typeof I=="undefined"){I=H}var J=b(I).data("transForm");if(!J){J={}}if(typeof J[t]=="undefined"){return}delete J[t]}},D={form:function(){b(H).find(q.substr(1,q.length-2).replace(/\|/g,",")).transForm(p);E(H,G(s))},fieldset:function(){this.form()},label:function(){if(b(H).is("[for]")){E(H,G("label"))}},input:function(){if(A=="button"){this.button()}else{E(H,G("input"));E(H,G(A));if(H.readonly&&(A!="color")){E(H,G("readOnly"))}if(this[A]){this[A]()}}},select:function(){if(b(H).attr("multiple")){this.multiple();return}if(!F){r=b(H).parent();return}r=b('<div class="'+G(s)+'"><div class="'+G("selected")+'"><span></span></div><div class="'+G("button")+'"><span>&nbsp;</span></div><div class="'+G("menu")+'"></div></div>');var I=r.find(o("menu")),L=r.find(o("selected")),M=r.find(o("button")),P=false;if(H.disabled){r.addClass(G("disabled"))}b(H).bind("keydown.tf",function(ac){var U=ac.keyCode,Y=(U==38),af=(U==40),ad=(U==13),T=(U==32),V=(U==9),ae=(U==27);if((ac.metaKey&&(U==82))||(U==116)){return true}if(ac.ctrlKey||ac.shiftKey||ac.altKey||ac.metaKey){return false}if(Y||af){var ab=O();var X=parseInt(ab.attr("class").split(G("index-"))[1].split(/\s/)[0]),S=I.find("div"),aa=I.data("count");if(Y){var W=(X==0)?(aa-1):(X-1);W=S[W];ab.removeClass(G("hover"));ab=b(W)}else{var Z=(X==aa-1)?0:(X+1);Z=S[Z];ab.removeClass(G("hover"));ab=b(Z)}S.removeClass(G("hover"));ab.addClass(G("hover"));w.set({current:ab});b(H).find("option").removeAttr("selected");ab.data("option").selected=true;K()}if(T||ad){r.toggleClass(G("opened"));O()}if(ae){r.removeClass(G("opened"))}if(!V){return false}}).bind("focus.tf",function(){r.addClass(G("focused"))}).bind("blur.tf",function(){setTimeout(function(){if(!P){r.removeClass(G("focused")).removeClass(G("opened"))}else{P=false;H.focus()}},100);return false}).after(r).detach().prependTo(r);var N=0,J=b(H).find("optgroup").get(0);if(J){I.html("<ul></ul>")}b(H).find("option, optgroup").each(function(){if(b(this).is("option")){var S=b('<div class="'+G("index-")+N+++'"><span>'+this.text+"</span></div>"),T=b(this).parent().is("optgroup")?J:(J?I.find("ul"):I);S.data({option:this}).appendTo(T)}else{J=b("<li><span>"+b(this).attr("label")+"</span></li>");b(I).find("ul").append(J)}});I.data({count:N});var K=function(){var S=b(H).find("option:selected").text();r.find(o("selected")+" span").html(S)},O=function(){var S=false;I.find("div").each(function(){if(b(this).data("option")===b(H).find("option:selected").get(0)){b(this).addClass(G("hover"));w.set({current:b(this)});S=b(this);return false}});return S},t=function(){if(!H.disabled){P=true;b(o("focused")).removeClass(G("focused"));O();setTimeout(function(){H.focus();r.toggleClass(G("opened"));var S=I.get(0);if(r.hasClass(G("opened"))&&(S.scrollHeight>S.clientHeight)){I.css({borderBottomRightRadius:0});I.find(o("last")).css({borderBottomRightRadius:0});c(I)}P=false},200)}return true};L.mousedown(t);M.mousedown(t);I.find("div").mousedown(function(){b(H).find("option").removeAttr("selected");b(this).data("option").selected=true;K();P=true;r.removeClass(G("opened"));setTimeout(function(){H.focus();P=false},200)}).mouseover(function(){I.find("div").removeClass(G("hover"));b(this).addClass(G("hover"))}).mouseout(function(){b(this).removeClass(G("hover"))});L.css({width:I.outerWidth()-l(L)});r.css({width:L.outerWidth()+M.outerWidth()});I.css({marginTop:r.outerHeight()-1,width:r.outerWidth()-l(I)}).find("li").first().addClass(G("first"));I.find("li").last().addClass(G("last"));I.find("li").each(function(){b(this).find("div").first().addClass(G("group-first")).parent().find("div").last().addClass(G("group-last"))});I.find("div").first().addClass(G("first"));I.find("div").last().addClass(G("last"));var Q=I.find("li").first(),R=I.find("li").last();if(Q.get(0)&&Q.prev().get(0)){Q.removeClass(G("first"))}if(R.get(0)&&R.next().get(0)){R.removeClass(G("last"))}K();k(r);H.transForm.value=function(S){if(typeof S=="undefined"){return H.value}H.value=S;K()}},multiple:function(){if(!F){r=b(H).parent();return}r=b('<div class="'+G("multiple")+'"></div>');var I=0,t=b(H).find("optgroup").get(0);if(t){r.html("<ul></ul>")}b(H).find("option, optgroup").each(function(){if(b(this).is("option")){var M=b('<div class="'+G("index-")+I+++'"><span>'+this.text+"</span></div>"),L=b(this).parent().is("optgroup"),N=L?t:(t?r.find("ul"):r);M.data({option:this}).appendTo(N);if(this.selected){M.addClass(G("selected"))}if(this===b(H).find("option").last().get(0)){M.addClass(G("last"))}if(!L&&(this===b(H).find("option").first().get(0))){M.addClass(G("first"))}if(L){if(this===b(this).parent().find("option").last().get(0)){M.addClass(G("group-last"))}if(this===b(this).parent().find("option").first().get(0)){M.addClass(G("group-first"))}}}else{t=b("<li><span>"+b(this).attr("label")+"</span></li>");if(this===b(H).find("optgroup, option").first().get(0)){t.addClass(G("first"))}if(this===b(H).find("optgroup").last().get(0)){t.addClass(G("last"))}r.find("ul").append(t)}});r.data({count:I});b(H).after(r).detach().prependTo(r);k(r);var K=r.get(0);if(K.scrollHeight>K.clientHeight){r.css({width:r.innerWidth()+a,borderTopRightRadius:0,borderBottomRightRadius:0});r.find("div"+o("first")).css({borderTopRightRadius:0});r.find("div"+o("last")).css({borderBottomRightRadius:0});r.find("li"+o("last")).css({borderBottomRightRadius:0});c(r)}var J=r.find("li"+o("last"));if(J.get(0)&&J.next().get(0)){J.removeClass(G("last"))}r.find("div").mouseenter(function(){if(!H.disabled){b(this).addClass(G("hover"))}}).mouseleave(function(){if(!H.disabled){b(this).removeClass(G("hover"))}}).click(function(O){if(H.disabled){return false}var N=b(this).data("option");if(N.selected){b(this).removeClass(G("selected"));N.selected=false}else{b(this).addClass(G("selected"));N.selected=true}if(O.shiftKey&&N.selected){var P,M=true,L=parseInt(b(this).attr("class").split(G("index-"))[1].split(/\s/)[0]);while(L&&M){L--;P=r.find(o("index-")+L);if(P.hasClass(G("selected"))){M=false}else{P.addClass(G("selected"));P.data("option").selected=true}}}});r.click(function(){var L=r.scrollTop();H.focus();r.scrollTop(L)});b(H).bind("focus.tf",function(){r.addClass(G("focused"))}).bind("blur.tf",function(){r.removeClass(G("focused"))}).bind("change.tf",function(){b(H).find("option").each(function(L){var M=r.find(o("index-")+L);if(this.selected){M.addClass(G("selected"))}else{M.removeClass(G("selected"))}})});H.transForm.values=function(L){if(typeof L=="undefined"){var M=[];b(H).find("option:selected").each(function(){M.push(this.value)});return M}if(!b.isArray(L)){return}b(H).find("option").attr({selected:false});r.find("div").removeClass(G("selected"));b.each(L,function(O,N){b(H).find("option").each(function(P){if(this.value===N){this.selected=true;r.find(o("index-")+P).addClass(G("selected"))}})})}},textarea:function(){if(F||u){b(H).css({overflow:"",height:"",borderTopRightRadius:"",borderBottomRightRadius:"",borderBottomLeftRadius:""})}E(H,G(s));if(H.readOnly){E(H,G("readOnly"))}if(!F){return}var I;if(e.textarea.autoExpand){b(H).css({overflow:"hidden"});I=function(){b(H).scrollTop(0);if(H.clientHeight>=H.scrollHeight){b(H).css({height:1})}b(H).css({height:H.scrollHeight+f(b(H),"b")})}}else{I=function(){var J=(H.clientHeight<H.scrollHeight),K=(H.clientWidth<H.scrollWidth);if(!B.r){B.r={tr:b(H).css("borderTopRightRadius"),br:b(H).css("borderBottomRightRadius"),bl:b(H).css("borderBottomLeftRadius")}}b(H).css({borderBottomRightRadius:(J||K)?0:B.r.br,borderTopRightRadius:J?0:B.r.tr,borderBottomLeftRadius:K?0:B.r.bl})}}var t=function(){I();var J=e.textarea.maxLength;if(J&&(H.value.length>J)){H.value=H.value.substr(0,J)}};t();b(H).bind("keyup.tf",t).bind("keydown.tf",t).bind("change.tf",t).bind("scroll.tf",t)},button:function(){if(!F){r=b(H).parent();return}r=b('<div class="'+G("button")+'"><span></span></div>');b(H).after(r).detach().appendTo(r);r.find("span").text(H.textContent);b(H).css({width:r.innerWidth()+l(r),height:r.innerHeight()+f(r),marginLeft:-parseInt(r.css("borderLeftWidth")),marginTop:-parseInt(r.css("borderTopWidth"))}).bind("focus.tf",function(){r.addClass(G("focused"))}).bind("blur.tf",function(){r.removeClass(G("focused"))}).bind("mousedown.tf",function(){r.addClass(G("focused"))})},file:function(){if(!F){r=b(H).parent();return}r=b('<div class="'+G(A)+'"><div class="'+G("button")+'"><span>'+e.file.browse+'</span></div><div class="'+G("info")+'"><span>&nbsp;</span></div></div>');b(H).after(r).detach().prependTo(r);var J=r.find(o("info")),I=r.find(o("button")),t=function(){var K=H.files;if(!K||(K.length<=0)){J.find("span").html(e.file.noFile)}else{J.find("span").text((K.length==1)?K[0]["name"]:e.file.count.replace("{count}",K.length))}r.attr("label",b(H).attr("label"))};J.css({width:r.innerWidth()-I.outerWidth()-l(J)});b(H).css({width:r.outerWidth(),height:r.outerHeight()}).bind("focus.tf",function(){b(o("focused")).removeClass(G("focused"));r.addClass(G("focused"))}).bind("blur.tf",function(){r.removeClass(G("focused"))}).bind("change.tf",t).bind("click.tf",function(){H.focus()});t()},checkbox:function(){if(!F){r=b(H).parent();return}r=b('<div class="'+G(A)+'"><span></span></div>');var I=function(){if(H.checked){r.addClass(G("checked"))}else{r.removeClass(G("checked"))}},t=b(H).attr("id");if(t){t=b('label[for="'+t+'"]')}k(t);b(H).after(r).detach().appendTo(r).bind("focus.tf",function(){r.addClass(G("focused"));if(t.get(0)){t.addClass(G("focused"))}}).bind("blur.tf",function(){r.removeClass(G("focused"));if(t.get(0)){t.removeClass(G("focused"))}}).bind("click.tf",function(){I();b(o("focused")).removeClass(G("focused"));r.addClass(G("focused"));if(t.get(0)){t.addClass(G("focused"))}H.focus()}).bind("change.tf",I);I();H.transForm.checked=function(J){if(typeof J=="undefined"){return H.checked}H.checked=!!J;I()}},radio:function(){if(!F){r=b(H).parent();return}r=b('<div class="'+G(A)+'"><span></span></div>');var K=b(H).parents("body, form").find('input[type="radio"][name="'+H.name+'"]'),t=function(){b(K).each(function(){if(this.checked){b(this).parent().addClass(G("checked"))}else{b(this).parent().removeClass(G("checked"))}})},I=function(L){if(L){b(K).parent().addClass(G("focused"));b.each(J,function(N,M){M.addClass(G("focused"))})}else{b(K).parent().removeClass(G("focused"));b.each(J,function(N,M){M.removeClass(G("focused"))})}},J=[];b.each(K,function(M,N){var L=b(N).attr("id");if(!L){return}L=b('label[for="'+L+'"]');if(!L.get(0)){return}J.push(L);k(L)});b(H).after(r).detach().appendTo(r).bind("focus.tf",function(){I(true)}).bind("blur.tf",function(){I(false)}).bind("click.tf",function(){t();I(true);H.focus()}).bind("change.tf",t);t();H.transForm.checked=function(L){if(typeof L=="undefined"){return H.checked}H.checked=!!L;t()}},submit:function(){this.button()},reset:function(){this.button()}};if(typeof H.transForm=="undefined"){H.transForm={disable:function(t){var I=r?r:H;H.disabled=!!t;if(!!t){I.addClass(G("disabled"))}else{I.removeClass(G("disabled"))}},destruct:function(){u=true;F=false;D[s]();v()}}}D[s]();if(F){w.set({prefix:y,transformed:true})}var v=function(){b(H).removeData("transForm").unbind(".tf");if(r){b(H).detach();r.after(H).detach()}if(typeof H.transForm!="undefined"){delete H.transForm}var t=b(H).attr("class");if(!t){return}b.each(t.split(/\s+/g),function(I,J){if(J.substr(0,y.length)==y){b(H).removeClass(J)}})};if(u){v()}if(typeof e.disabled!="undefined"){H.disabled=!!e.disabled;if(!r){r=b(H)}if(e.disabled){r.addClass(G("disabled"))}else{r.removeClass(G("disabled"))}}if((typeof e.readonly!="undefined")&&((s=="textarea")||((s=="input")&&(A!="color")&&(i.indexOf("|"+A+"|")!==-1)))){var x=!!e.readonly;b(H).attr({readonly:x});if(!z){return}if(x){b(H).addClass(G("readOnly"))}else{b(H).removeClass(G("readOnly"))}}});return b(this)}})(jQuery);