/*!
 * jQuery TransForm plugin v0.9
 * 2014-07-27
 *
 * Copyright (c) 2010-2014 Pavel Tzonkov <sunhater@sunhater.com>
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b){var a;b.fn.transForm=function(m){if(!a){var c=b("<div></div>").css({display:"block",visibility:"visible",position:"absolute",overflow:"auto",width:100,height:100,top:-1000,left:-1000}).prependTo("body").append("<div></div>").find("div").css({display:"block",visibility:"visible",width:"100%",height:200});a=100-c.width();c.parent().remove()}var n="|form|fieldset|input|select|textarea|button|label|",h="|button|text|file|checkbox|radio|submit|reset|password|",d={cssPrefix:"tf-",file:{noFile:"No file chosen",browse:"Browse",count:"{count} files"},textarea:{autoExpand:false,maxLength:0}},l=function(p,q,t){var s=0,o;if(!t){t="mbp"}if(/m/i.test(t)){o=parseInt(b(p).css("margin-"+q));if(o){s+=o}}if(/b/i.test(t)){o=parseInt(b(p).css("border-"+q+"-width"));if(o){s+=o}}if(/p/i.test(t)){o=parseInt(b(p).css("padding-"+q));if(o){s+=o}}return s},g=function(o,p){return l(o,"left",p)},i=function(o,p){return l(o,"top",p)},f=function(o,p){return l(o,"right",p)},k=function(o,p){return l(o,"bottom",p)},j=function(o,p){return(g(o,p)+f(o,p))},e=function(o,p){return(i(o,p)+k(o,p))};b.extend(true,d,m);b(this).each(function(){var F=this,q=b(F).prop("tagName").toLowerCase();if(n.indexOf("|"+q+"|")==-1){return}var A=(m===false),x=b(F).data("transForm"),D=(!A&&!x),r=(A&&x),w=x?x.prefix:d.cssPrefix,y=b(F).attr("type"),y=y?y:"text",p,z={},C=function(G,t){if(D){b(G).addClass(t)}else{if(r){b(G).removeClass(t)}}},E=function(t){return w+t},o=function(t){return"."+E(t)},u={set:function(t,G){if(typeof G=="undefined"){G=F}var H=b(G).data("transForm");if(!H){H={}}b.extend(true,H,t);b(G).data("transForm",H)},get:function(t,G){if(typeof G=="undefined"){G=F}var H=b(G).data("transForm");if(typeof t=="undefined"){return H}if(!H){H={}}return H[t]},remove:function(t,G){if(typeof G=="undefined"){G=F}var H=b(G).data("transForm");if(!H){H={}}if(typeof H[t]=="undefined"){return}delete H[t]}},B={form:function(){b(F).find(n.substr(1,n.length-2).replace(/\|/g,",")).transForm(m);C(F,E(q))},fieldset:function(){this.form()},label:function(){if(b(F).is("[for]")){C(F,E("label"))}},input:function(){if(h.indexOf("|"+y+"|")!=-1){this[y]()}},select:function(){if(b(F).attr("multiple")){this.multiple();return}if(!D){p=b(F).parent();return}p=b('<div class="'+E(q)+'"><div class="'+E("selected")+'"><span></span></div><div class="'+E("button")+'"><span>&nbsp;</span></div><div class="'+E("menu")+'"></div></div>');var G=p.find(o("menu")),J=p.find(o("selected")),K=p.find(o("button")),N=false;if(F.disabled){p.addClass(E("disabled"))}b(F).bind("keydown.tf",function(aa){var S=aa.keyCode,W=(S==38),ad=(S==40),ab=(S==13),R=(S==32),T=(S==9),ac=(S==27);if((aa.metaKey&&(S==82))||(S==116)){return true}if(aa.ctrlKey||aa.shiftKey||aa.altKey||aa.metaKey){return false}if(W||ad){var Z=M();var V=parseInt(Z.attr("class").split(E("index-"))[1].split(/\s/)[0]),Q=G.find("div"),Y=G.data("count");if(W){var U=(V==0)?(Y-1):(V-1);U=Q[U];Z.removeClass(E("hover"));Z=b(U)}else{var X=(V==Y-1)?0:(V+1);X=Q[X];Z.removeClass(E("hover"));Z=b(X)}Q.removeClass(E("hover"));Z.addClass(E("hover"));u.set({current:Z});b(F).find("option").removeAttr("selected");Z.data("option").selected=true;I()}if(R||ab){p.toggleClass(E("opened"));M()}if(ac){p.removeClass(E("opened"))}if(!T){return false}}).bind("focus.tf",function(){p.addClass(E("focused"))}).bind("blur.tf",function(){setTimeout(function(){if(!N){p.removeClass(E("focused")).removeClass(E("opened"))}else{N=false;F.focus()}},100);return false}).after(p).detach().prependTo(p);var L=0,H=b(F).find("optgroup").get(0);if(H){G.html("<ul></ul>")}b(F).find("option, optgroup").each(function(){if(b(this).is("option")){var Q=b('<div class="'+E("index-")+L+++'"><span>'+this.text+"</span></div>"),R=b(this).parent().is("optgroup")?H:(H?G.find("ul"):G);Q.data({option:this}).appendTo(R)}else{H=b("<li><span>"+b(this).attr("label")+"</span></li>");b(G).find("ul").append(H)}});G.data({count:L});var I=function(){var Q=b(F).find("option:selected").text();p.find(o("selected")+" span").html(Q)},M=function(){var Q=false;G.find("div").each(function(){if(b(this).data("option")===b(F).find("option:selected").get(0)){b(this).addClass(E("hover"));u.set({current:b(this)});Q=b(this);return false}});return Q},t=function(){if(!F.disabled){N=true;b(o("focused")).removeClass(E("focused"));M();setTimeout(function(){F.focus();p.toggleClass(E("opened"));var Q=G.get(0);if(p.hasClass(E("opened"))&&(Q.scrollHeight>Q.clientHeight)){G.css({borderBottomRightRadius:0});G.find(o("last")).css({borderBottomRightRadius:0})}N=false},200)}};J.mousedown(t);K.mousedown(t);G.find("div").mousedown(function(){b(F).find("option").removeAttr("selected");b(this).data("option").selected=true;I();N=true;p.removeClass(E("opened"));setTimeout(function(){F.focus();N=false},200)}).mouseover(function(){G.find("div").removeClass(E("hover"));b(this).addClass(E("hover"))}).mouseout(function(){b(this).removeClass(E("hover"))});J.css({width:G.outerWidth()-j(J)});p.css({width:J.outerWidth()+K.outerWidth()});G.css({marginTop:p.outerHeight()-1,width:p.outerWidth()-j(G)}).find("li").first().addClass(E("first"));G.find("li").last().addClass(E("last"));G.find("li").each(function(){b(this).find("div").first().addClass(E("group-first")).parent().find("div").last().addClass(E("group-last"))});G.find("div").first().addClass(E("first"));G.find("div").last().addClass(E("last"));var O=G.find("li").first(),P=G.find("li").last();if(O.get(0)&&O.prev().get(0)){O.removeClass(E("first"))}if(P.get(0)&&P.next().get(0)){P.removeClass(E("last"))}I();F.transForm.value=function(Q){if(typeof Q=="undefined"){return F.value}F.value=Q;I()}},multiple:function(){if(!D){p=b(F).parent();return}p=b('<div class="'+E("multiple")+'"></div>');var G=0,t=b(F).find("optgroup").get(0);if(t){p.html("<ul></ul>")}b(F).find("option, optgroup").each(function(){if(b(this).is("option")){var K=b('<div class="'+E("index-")+G+++'"><span>'+this.text+"</span></div>"),J=b(this).parent().is("optgroup"),L=J?t:(t?p.find("ul"):p);K.data({option:this}).appendTo(L);if(this.selected){K.addClass(E("selected"))}if(this===b(F).find("option").last().get(0)){K.addClass(E("last"))}if(!J&&(this===b(F).find("option").first().get(0))){K.addClass(E("first"))}if(J){if(this===b(this).parent().find("option").last().get(0)){K.addClass(E("group-last"))}if(this===b(this).parent().find("option").first().get(0)){K.addClass(E("group-first"))}}}else{t=b("<li><span>"+b(this).attr("label")+"</span></li>");if(this===b(F).find("optgroup, option").first().get(0)){t.addClass(E("first"))}if(this===b(F).find("optgroup").last().get(0)){t.addClass(E("last"))}p.find("ul").append(t)}});p.data({count:G});b(F).after(p).detach().prependTo(p);var I=p.get(0);if(I.scrollHeight>I.clientHeight){p.css({width:p.innerWidth()+a,borderTopRightRadius:0,borderBottomRightRadius:0});p.find("div"+o("first")).css({borderTopRightRadius:0});p.find("div"+o("last")).css({borderBottomRightRadius:0});p.find("li"+o("last")).css({borderBottomRightRadius:0})}var H=p.find("li"+o("last"));if(H.get(0)&&H.next().get(0)){H.removeClass(E("last"))}p.find("div").mouseenter(function(){if(!F.disabled){b(this).addClass(E("hover"))}}).mouseleave(function(){if(!F.disabled){b(this).removeClass(E("hover"))}}).click(function(M){if(F.disabled){return false}var L=b(this).data("option");if(L.selected){b(this).removeClass(E("selected"));L.selected=false}else{b(this).addClass(E("selected"));L.selected=true}if(M.shiftKey&&L.selected){var N,K=true,J=parseInt(b(this).attr("class").split(E("index-"))[1].split(/\s/)[0]);while(J&&K){J--;N=p.find(o("index-")+J);if(N.hasClass(E("selected"))){K=false}else{N.addClass(E("selected"));N.data("option").selected=true}}}});p.click(function(){var J=p.scrollTop();F.focus();p.scrollTop(J)});b(F).bind("focus.tf",function(){p.addClass(E("focused"))}).bind("blur.tf",function(){p.removeClass(E("focused"))}).bind("change.tf",function(){b(F).find("option").each(function(J){var K=p.find(o("index-")+J);if(this.selected){K.addClass(E("selected"))}else{K.removeClass(E("selected"))}})});F.transForm.values=function(J){if(typeof J=="undefined"){var K=[];b(F).find("option:selected").each(function(){K.push(this.value)});return K}if(!b.isArray(J)){return}b(F).find("option").attr({selected:false});p.find("div").removeClass(E("selected"));b.each(J,function(M,L){b(F).find("option").each(function(N){if(this.value===L){this.selected=true;p.find(o("index-")+N).addClass(E("selected"))}})})}},textarea:function(){if(D||r){b(F).css({overflow:"",height:"",borderTopRightRadius:"",borderBottomRightRadius:"",borderBottomLeftRadius:""})}C(F,E(q));if(F.readOnly){C(F,E("readOnly"))}if(!D){return}var G;if(d.textarea.autoExpand){b(F).css({overflow:"hidden"});G=function(){b(F).scrollTop(0);if(F.clientHeight>=F.scrollHeight){b(F).css({height:1})}b(F).css({height:F.scrollHeight+e(b(F),"b")})}}else{G=function(){var H=(F.clientHeight<F.scrollHeight),I=(F.clientWidth<F.scrollWidth);if(!z.r){z.r={tr:b(F).css("borderTopRightRadius"),br:b(F).css("borderBottomRightRadius"),bl:b(F).css("borderBottomLeftRadius")}}b(F).css({borderBottomRightRadius:(H||I)?0:z.r.br,borderTopRightRadius:H?0:z.r.tr,borderBottomLeftRadius:I?0:z.r.bl})}}var t=function(){G();var H=d.textarea.maxLength;if(H&&(F.value.length>H)){F.value=F.value.substr(0,H)}};t();b(F).bind("keyup.tf",t).bind("keydown.tf",t).bind("change.tf",t).bind("scroll.tf",t)},button:function(){if(!D){p=b(F).parent();return}p=b('<div class="'+E("button")+'"><span></span></div>');b(F).after(p).detach().appendTo(p);p.find("span").text(F.textContent);b(F).css({width:p.innerWidth()+j(p),height:p.innerHeight()+e(p),marginLeft:-parseInt(p.css("borderLeftWidth")),marginTop:-parseInt(p.css("borderTopWidth"))}).bind("focus.tf",function(){p.addClass(E("focused"))}).bind("blur.tf",function(){p.removeClass(E("focused"))}).bind("mousedown.tf",function(){p.addClass(E("focused"))})},text:function(){C(F,E("text"));if(F.readOnly){C(F,E("readOnly"))}},file:function(){if(!D){p=b(F).parent();return}p=b('<div class="'+E(y)+'"><div class="'+E("button")+'"><span>'+d.file.browse+'</span></div><div class="'+E("info")+'"><span>&nbsp;</span></div></div>');b(F).after(p).detach().prependTo(p);var H=p.find(o("info")),G=p.find(o("button")),t=function(){var I=F.files;if(!I||(I.length<=0)){H.find("span").html(d.file.noFile)}else{H.find("span").text((I.length==1)?I[0]["name"]:d.file.count.replace("{count}",I.length))}p.attr("label",b(F).attr("label"))};H.css({width:p.innerWidth()-G.outerWidth()-j(H)});b(F).css({width:p.outerWidth(),height:p.outerHeight()}).bind("focus.tf",function(){b(o("focused")).removeClass(E("focused"));p.addClass(E("focused"))}).bind("blur.tf",function(){p.removeClass(E("focused"))}).bind("change.tf",t).bind("click.tf",function(){F.focus()});t()},checkbox:function(){if(!D){p=b(F).parent();return}p=b('<div class="'+E(y)+'"><span></span></div>');var t=function(){if(F.checked){p.addClass(E("checked"))}else{p.removeClass(E("checked"))}};b(F).after(p).detach().appendTo(p).bind("focus.tf",function(){p.addClass(E("focused"))}).bind("blur.tf",function(){p.removeClass(E("focused"))}).bind("click.tf",function(){t();b(o("focused")).removeClass(E("focused"));p.addClass(E("focused"));F.focus()}).bind("change.tf",t);t();F.transForm.checked=function(G){if(typeof G=="undefined"){return F.checked}F.checked=!!G;t()}},radio:function(){if(!D){p=b(F).parent();return}p=b('<div class="'+E(y)+'"><span></span></div>');var H=b(F).parents("body, form").find('input[type="radio"][name="'+F.name+'"]'),t=function(){b(H).each(function(){if(this.checked){b(this).parent().addClass(E("checked"))}else{b(this).parent().removeClass(E("checked"))}})},G=function(I){if(I){b(H).parent().addClass(E("focused"))}else{b(H).parent().removeClass(E("focused"))}};b(F).after(p).detach().appendTo(p).bind("focus.tf",function(){G(true)}).bind("blur.tf",function(){G(false)}).bind("click.tf",function(){t();G(true);F.focus()}).bind("change.tf",t);t();F.transForm.checked=function(I){if(typeof I=="undefined"){return F.checked}F.checked=!!I;t()}},submit:function(){return this.button()},reset:function(){return this.button()},password:function(){return this.text()}};if(typeof F.transForm=="undefined"){F.transForm={disable:function(t){var G=p?p:F;F.disabled=!!t;if(!!t){G.addClass(E("disabled"))}else{G.removeClass(E("disabled"))}}}}B[q]();if(D){u.set({prefix:w,transformed:true})}if(r){b(F).removeData("transForm").unbind(".tf");if(p){b(F).detach();p.after(F).detach()}if(typeof F.transForm!="undefined"){delete F.transForm}var s=b(F).attr("class");if(!s){return}b.each(s.split(/\s+/g),function(t,G){if(G.substr(0,w.length)==w){b(F).removeClass(G)}})}if(typeof d.disabled!="undefined"){F.disabled=!!d.disabled;if(!p){p=b(F)}if(d.disabled){p.addClass(E("disabled"))}else{p.removeClass(E("disabled"))}}if((typeof d.readonly!="undefined")&&((q=="textarea")||((q=="input")&&((y=="text")||(y=="password"))))){var v=!!d.readonly;b(F).attr({readonly:v});if(!x){return}if(v){b(F).addClass(E("readOnly"))}else{b(F).removeClass(E("readOnly"))}}});return b(this)}})(jQuery);